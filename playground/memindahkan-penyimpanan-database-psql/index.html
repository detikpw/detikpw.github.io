<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.a2f933b7ab5f58f2ecfb.css">code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.1.20"/><style data-styled="iZAhAR  kppRiI gpmgOy pjOvZ fIVgrz kvLxcj iuFNNj jTDeLO dNfpBI hjBgRy iySUXA jlOmFi kWnhTT bvIIgQ kuZvTA bkLGPF gWrQZN cGtxmw jYtvCn" data-styled-version="4.1.3">
/* sc-component-id: sc-bdVaJa */
.kuZvTA{box-sizing:border-box;padding-left:16px;padding-right:16px;width:100%;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;} @media screen and (min-width:40em){.kuZvTA{width:100%;}} @media screen and (min-width:52em){.kuZvTA{width:50%;}}
/* sc-component-id: sc-bwzfXH */
.gpmgOy{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.pjOvZ{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.fIVgrz{box-sizing:border-box;padding-top:8px;padding-bottom:8px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}
/* sc-component-id: sc-htpNat */
.hjBgRy{box-sizing:border-box;color:white;line-height:1.2;}.iySUXA{box-sizing:border-box;font-size:2.25rem;font-family:Exo;}.jlOmFi{box-sizing:border-box;margin-top:0px;margin-bottom:0px;font-size:.625rem;font-weight:400;line-height:1.6;}.kWnhTT{box-sizing:border-box;font-size:.625rem;font-family:400px;line-height:1.2;}
/* sc-component-id: sc-htoDjs */
.iuFNNj{box-sizing:border-box;margin-left:8px;margin-right:8px;color:black;}.jTDeLO{box-sizing:border-box;color:black;-webkit-text-decoration:none;text-decoration:none;}.dNfpBI{box-sizing:border-box;color:black;}
/* sc-component-id: sc-jTzLTM */
.kvLxcj{box-sizing:border-box;margin-bottom:32px;padding-left:16px;padding-right:16px;padding-top:8px;padding-bottom:8px;background-color:black;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-transform:uppercase;border-radius:0 0 10px 10px;}
/* sc-component-id: sc-fjdhpX */
.bvIIgQ{box-sizing:border-box;font-size:1.25rem;font-family:Exo;font-style:italic;}
/* sc-component-id: Desktop___StyledFlex-sc-15jbbmv-0 */
.kppRiI{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-top:5px solid #000;}
/* sc-component-id: sc-global-113577246 */
body{margin:0;height:100%;} ::-webkit-scrollbar{width:0px;background:transparent;} ::-webkit-scrollbar-thumb{background:#FF0000;} blockquote{font-family:"volkhov",serif;font-style:italic;font-size:1rem;line-height:1.5;margin-bottom:1.5rem;padding-left:20px;border-left:8px solid #000;} a{color:black;}
/* sc-component-id: sc-jzJRlG */
.iZAhAR{box-sizing:border-box;font-family:HelveticaNeueArabic,NeueHelveticaW01,Helvetica,HelveticaWorld,Arial,TazuganeGothic,sans-serif;}
/* sc-component-id: HeaderSection___StyledBox-eltv8w-0 */
.bkLGPF{box-sizing:border-box;padding-top:8px;padding-bottom:8px;}
/* sc-component-id: Article___StyledBox-sc-144dnoy-0 */
.jYtvCn{box-sizing:border-box;line-height:1.6;}
/* sc-component-id: sc-cSHVUG */
.gWrQZN{box-sizing:border-box;margin-bottom:16px;margin-top:32px;font-size:3.25rem;font-family:'Volkhov',serif;font-weight:400;text-align:center;line-height:1;font-style:italic;}
/* sc-component-id: sc-kAzzGY */
.cGtxmw{box-sizing:border-box;-webkit-flex:1;-ms-flex:1;flex:1;}</style><title data-react-helmet="true">Memindahkan Penyimpanan Database Postgre Ke Direktori Lain | Catatan Detik</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Exo" rel="stylesheet"/><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Volkhov" rel="stylesheet"/><meta data-react-helmet="true" name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover"/><meta data-react-helmet="true" name="description" content="Artikel ini ketika dibuat sempat terpotong 2-3 bulan besar kemungkinan ada kesalahan. Maka saya semakin tidak bertanggung jawab bila database anda hilang, malfunction, atau dicomot kucing. Sering dapat notifikasi cinta dari om Zorin bahwa direktori…"/><title data-react-helmet="true"></title><link as="script" rel="preload" href="/webpack-runtime-e19dbc97ee5f6990dab5.js"/><link as="script" rel="preload" href="/styles-f712a68a9752910f28ab.js"/><link as="script" rel="preload" href="/app-ed32160119f27ee5aec7.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-9de0a7a723df539a56e7.js"/><link as="fetch" rel="preload" href="/static/d/990/path---playground-memindahkan-penyimpanan-database-psql-c-3-a-9a7-CeHcFBnxwmG0gPJ9TDqf7AojmM.json" crossOrigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="sc-bdVaJa sc-jzJRlG iZAhAR"><div class="sc-bdVaJa sc-bwzfXH Desktop___StyledFlex-sc-15jbbmv-0 kppRiI"><div class="sc-bdVaJa sc-bwzfXH gpmgOy"><div class="sc-bdVaJa sc-bwzfXH sc-jTzLTM kvLxcj"><a mx="2" color="black" _css="[object Object]" class="sc-bdVaJa sc-ifAKCX sc-htoDjs iuFNNj" href="/anime"><div color="white" class="sc-bdVaJa sc-htpNat hjBgRy">Anime</div></a><a mx="2" color="black" _css="[object Object]" class="sc-bdVaJa sc-ifAKCX sc-htoDjs iuFNNj" href="/lifehack"><div color="white" class="sc-bdVaJa sc-htpNat hjBgRy">Lifehack</div></a><a mx="2" color="black" _css="[object Object]" class="sc-bdVaJa sc-ifAKCX sc-htoDjs iuFNNj" href="/playground"><div color="white" class="sc-bdVaJa sc-htpNat hjBgRy">Playground</div></a></div><a color="black" _css="[object Object]" class="sc-bdVaJa sc-ifAKCX sc-htoDjs jTDeLO" href="/"><div font-family="Exo" font-size="2.25rem" class="sc-bdVaJa sc-htpNat iySUXA">Catatan Detik</div></a><div font-family="Exo" font-size="1.25rem" class="sc-bdVaJa sc-htpNat sc-fjdhpX bvIIgQ">Just A Note</div></div><div width="1,1,0.5" class="sc-bdVaJa kuZvTA"><div class="sc-bdVaJa HeaderSection___StyledBox-eltv8w-0 bkLGPF"><h1 font-family="&#x27;Volkhov&#x27;, serif" font-size="3.25rem" font-weight="400" class="sc-bdVaJa sc-htpNat sc-cSHVUG gWrQZN">Memindahkan Penyimpanan Database Postgre Ke Direktori Lain</h1></div><div class="sc-bdVaJa sc-bwzfXH pjOvZ"><div font-size=".625rem" font-weight="400" class="sc-bdVaJa sc-htpNat jlOmFi">September 21, 2017</div><div class="sc-bdVaJa sc-kAzzGY cGtxmw"></div><div font-size=".625rem" font-weight="400" class="sc-bdVaJa sc-htpNat jlOmFi">2 minutes</div></div><div class="sc-bdVaJa Article___StyledBox-sc-144dnoy-0 jYtvCn"><div><blockquote>
<p>Artikel ini ketika dibuat sempat terpotong 2-3 bulan besar kemungkinan ada kesalahan. Maka saya semakin tidak bertanggung jawab bila database anda hilang, malfunction, atau dicomot kucing.</p>
</blockquote>
<p>Sering dapat notifikasi cinta dari om Zorin bahwa direktori root di notebook kantor udah sekarat, ternyata gemuk karena image docker dan postgresql (psql) image docker 15 GB dan psql yang mencapai 30 GB. Image docker tanpa pikir panjang langsung hapus, sebenarnya lumayan sih langsung ada space sekitar 17 GB, tapi penasaran ternyata data psql bisa dipindahkan, nah kebetulan yang bikin nih root sempit karena hdd yang dijadikan root itu SSD 100 GB hasil bagi-bagi, root dapat jatah 67 GB, jadi rencananya mau bikin 1 partisi lagi yang diambil dari hdd yang lain (non SSD 1 TB), karena data psql ini aslinya udah jarang dipake, nampaknya tak masalah jika saya pindahkan ke non ssd.</p>
<p>Yang akan dipelajari:</p>
<ol>
<li>Konfigurasi psql.</li>
<li>Konfigurasi auto mount partisi menggunakan fstab.</li>
</ol>
<p>Yang perlu dipersiapkan:</p>
<ol>
<li>Partisi linux (saya menggunakan ext4).</li>
<li>Mengetahui lokasi default data psql.</li>
</ol>
<p>Langkah-langkah:</p>
<ol>
<li>
<p>Masuk ke psql command line</p>
<p><code>sudo -u postgres psql</code></p>
</li>
<li>
<p>Lalu gunakan command di bawah ini untuk mengetahui lokasi default data postgre anda, bila sudah ketik <code>\q</code> untuk keluar dari cli-nya postgre</p>
<p><code>SHOW data_directory;</code></p>
<pre><code class="language-bash">    data_directory
------------------------------
/var/lib/postgresql/9.5/main
(1 row)
</code></pre>
</li>
<li>
<p>Matikan service postgre anda</p>
<p><code>sudo systemctl stop postgresql</code></p>
</li>
<li>
<p>Buat <em>mount point</em></p>
<p><code>sudo mkdir /media/data</code></p>
</li>
<li>
<p>Catat uuid pada partisi yang akan anda gunakan</p>
<p><code>sudo blkid</code></p>
</li>
<li>
<p>Gunakan editor favorit anda untuk mengubah file /etc/fstab, gunakan uuid yang didapat pada langkah sebelumnya</p>
<p><code>sudo vim /etc/fstab</code>
<code>UUID=0f713ecd-564f-4a14-868b-2aefe36ed2dc /media/data ext4 defaults 0 2</code></p>
</li>
<li>
<p>Pastikan partisi baru anda bisa digunakan, bila sudah salin folder postgre ke partisi yang baru saja dibuat</p>
<p><code>sudo rsync -av /var/lib/postgresql /media/data/psql</code></p>
</li>
<li>
<p>Bila sudah selesai backup database</p>
<p><code>sudo mv /var/lib/postgresql/9.5/main /var/lib/postgresql/9.5/main.bak</code></p>
</li>
<li>
<p>Lalu ke configurasi postgre ubah nilah data_directory
<code>sudo vim /etc/postgresql/9.5/main/postgresql.conf</code></p>
<p><code>data_directory = '/media/data/psql/postgresql/9.5/main'</code></p>
</li>
<li>
<p>Hidupkan kembali postgre service</p>
<p><code>sudo systemctl start postgresql</code></p>
</li>
<li>
<p>Gunakan langkah no.2 untuk cek kembali apakah data_directory sudah mengarah ke partisi baru</p>
</li>
</ol>
<p>Bila iya bisa restart kembali postgre service-nya untuk memastikan.</p>
<p>Edit:
Baca ulang ternyata kurang referensi:
<a href="https://www.digitalocean.com/community/tutorials/how-to-move-a-postgresql-data-directory-to-a-new-location-on-ubuntu-16-04">digital ocean</a></p></div></div></div><hr/><div width="1,1,0.5" class="sc-bdVaJa kuZvTA"><div class="sc-bdVaJa sc-bwzfXH fIVgrz"><div font-family="400" font-size=".625rem" class="sc-bdVaJa sc-htpNat kWnhTT">© 2019 Detik P Warjaya. Powered by <a href="https://www.gatsbyjs.org/" target="_blank" color="black" class="sc-bdVaJa sc-ifAKCX sc-htoDjs dNfpBI">Gatsby</a>  inspired by jekyll theme <a href="https://github.com/mmistakes/so-simple-theme" target="_blank" color="black" class="sc-bdVaJa sc-ifAKCX sc-htoDjs dNfpBI">So Simple Theme </a> and <a href="vice.com" target="_blank" color="black" class="sc-bdVaJa sc-ifAKCX sc-htoDjs dNfpBI">vice.com</a></div></div></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"playground-memindahkan-penyimpanan-database-psql-c3a","path":"/playground/memindahkan-penyimpanan-database-psql/"};window.dataPath="990/path---playground-memindahkan-penyimpanan-database-psql-c-3-a-9a7-CeHcFBnxwmG0gPJ9TDqf7AojmM";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-ed32160119f27ee5aec7.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-9de0a7a723df539a56e7.js"],"component---src-templates-category-post-js":["/component---src-templates-category-post-js-13a59b294d927b372a9d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-4329e2e4f3b59e1fda6a.js"],"pages-manifest":["/pages-manifest-c3a0529306c536ab82ea.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-9de0a7a723df539a56e7.js" async=""></script><script src="/app-ed32160119f27ee5aec7.js" async=""></script><script src="/styles-f712a68a9752910f28ab.js" async=""></script><script src="/webpack-runtime-e19dbc97ee5f6990dab5.js" async=""></script></body></html>